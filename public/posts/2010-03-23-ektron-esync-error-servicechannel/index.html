<!DOCTYPE html>
<html lang='en'><head>
  <meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='description' content='Ektron’s eSync service is a great product when it’s working but getting the initial configuration right can be a bit fiddly.&nbsp; I’ve compiled a quick diagnostic procedure to resolve the most common issues, as well as some of the more common issues.
Note: The Ektron Windows Service is usually in: C:\Program Files\Ektron\EktronWindowsService30. After any configuration change restart the Ektron Windows Service on every node in the relationship.
 Restart the Ektron Windows Service on every node within the relationship  Ensure that the Ektron license is valid for every database within the relationship  Ensure that you can access http://&lt;DOMAINNAME&gt;/workarea/ServerControlWS.'>
<meta name='theme-color' content='#ffcd00'>

<meta property='og:title' content='Diagnosing an Ektron eSync Relationship • Martin Jarvis'>
<meta property='og:description' content='Ektron’s eSync service is a great product when it’s working but getting the initial configuration right can be a bit fiddly.&nbsp; I’ve compiled a quick diagnostic procedure to resolve the most common issues, as well as some of the more common issues.
Note: The Ektron Windows Service is usually in: C:\Program Files\Ektron\EktronWindowsService30. After any configuration change restart the Ektron Windows Service on every node in the relationship.
 Restart the Ektron Windows Service on every node within the relationship  Ensure that the Ektron license is valid for every database within the relationship  Ensure that you can access http://&lt;DOMAINNAME&gt;/workarea/ServerControlWS.'>
<meta property='og:url' content='https://codifice.uk/posts/2010-03-23-ektron-esync-error-servicechannel/'>
<meta property='og:site_name' content='Codifice'>
<meta property='og:type' content='article'><meta property='og:image' content='https://www.gravatar.com/avatar/f3a1aad34bc567d039ed8504c741fc38?s=256'><meta property='article:section' content='posts'><meta property='article:tag' content='esync'><meta property='article:tag' content='ektron'><meta property='article:tag' content='servicechannel'><meta property='article:tag' content='wcf'><meta property='article:tag' content='troubleshooting'><meta property='article:tag' content='faulted'><meta property='article:published_time' content='2010-03-23T00:00:00Z'/><meta property='article:modified_time' content='2013-02-15T00:00:00Z'/><meta name='twitter:card' content='summary'><meta name='twitter:creator' content='@codificeuk'>

<meta name="generator" content="Hugo 0.63.2" />

  <title>Diagnosing an Ektron eSync Relationship • Martin Jarvis</title>
  <link rel='canonical' href='https://codifice.uk/posts/2010-03-23-ektron-esync-error-servicechannel/'>
  
  
  <link rel='icon' href='/favicon.png'>
<link rel='stylesheet' href='/assets/css/main.ab98e12b.css'><link rel='stylesheet' href='/css/custom.css'><style>
:root{--color-accent:#ffcd00;}
</style>

  

</head>
<body class='page type-posts has-sidebar'>

  <div class='site'><div id='sidebar' class='sidebar'>
  <a class='screen-reader-text' href='#main-menu'>Skip to Main Menu</a>

  <div class='container'><section class='widget widget-about sep-after'>
  <header>
    
    <div class='logo'>
      <a href='/'>
        <img src='/images/logo.png'>
      </a>
    </div>
    
    <h2 class='title site-title '>
      <a href='/'>
      Codifice
      </a>
    </h2>
    <div class='desc'>
    Artisan Development and Architecture
    </div>
  </header>

</section>
<section class='widget widget-sidebar_menu sep-after'><nav id='sidebar-menu' class='menu sidebar-menu' aria-label='Sidebar Menu'>
    <div class='container'>
      <ul><li class='item'>
  <a href='/'>Home</a></li><li class='item'>
  <a href='/posts/'>Posts</a></li></ul>
    </div>
  </nav>

</section><section class='widget widget-search sep-after'>
  <header>
    <h4 class='title widget-title'>Search</h4>
  </header>

  <form action='/search' id='search-form' class='search-form'>
    <label>
      <span class='screen-reader-text'>Search</span>
      <input id='search-term' class='search-term' type='search' name='q' placeholder='Search&hellip;'>
    </label></form>

</section>
<section class='widget widget-recent_posts sep-after'>
  <header>
    <h4 class='title widget-title'>Recent Posts</h4>
  </header>

  <ul class='list'>
  
    <li class='item'>
  <div class='meta'>
    <span>
  <span class='screen-reader-text'>Posted on </span>
  <time datetime='2012-11-22T00:00:00Z'>2012, Nov 22</time>
</span>

  </div>
  <header class='item-header'>
    <h3 class='item-title'>
      <a href='/posts/2012-11-22-notes-on-configuring-new-episerver-6-r2/'>Notes on Configuring a New EPiServer 6 R2 Website for Continuous Integration</a>
    </h3>
  </header>
</li>

  
    <li class='item'>
  <div class='meta'>
    <span>
  <span class='screen-reader-text'>Posted on </span>
  <time datetime='2012-01-15T00:00:00Z'>2012, Jan 15</time>
</span>

  </div>
  <header class='item-header'>
    <h3 class='item-title'>
      <a href='/posts/2012-01-15-announcing-mvc3-validation-groups/'>Announcing MVC3 Validation Groups</a>
    </h3>
  </header>
</li>

  
    <li class='item'>
  <div class='meta'>
    <span>
  <span class='screen-reader-text'>Posted on </span>
  <time datetime='2011-11-01T00:00:00Z'>2011, Nov 01</time>
</span>

  </div>
  <header class='item-header'>
    <h3 class='item-title'>
      <a href='/posts/2011-11-01-ektron-finding-missing-content-in-index/'>Ektron: Finding “Missing” Content in the Index on 64bit Windows</a>
    </h3>
  </header>
</li>

  
    <li class='item'>
  <div class='meta'>
    <span>
  <span class='screen-reader-text'>Posted on </span>
  <time datetime='2011-08-16T00:00:00Z'>2011, Aug 16</time>
</span>

  </div>
  <header class='item-header'>
    <h3 class='item-title'>
      <a href='/posts/2011-08-16-persisting-page-title-across-update/'>Persisting the Page Title across Update Panel Post backs</a>
    </h3>
  </header>
</li>

  
    <li class='item'>
  <div class='meta'>
    <span>
  <span class='screen-reader-text'>Posted on </span>
  <time datetime='2011-08-04T00:00:00Z'>2011, Aug 04</time>
</span>

  </div>
  <header class='item-header'>
    <h3 class='item-title'>
      <a href='/posts/2011-08-04-ektron-treating-office-files-as-normal/'>Ektron: Treating Office Files as Normal DMS Assets</a>
    </h3>
  </header>
</li>

  
  </ul>
</section>
<section class='widget widget-taxonomy_cloud sep-after'>
  <header>
    <h4 class='title widget-title'>Tags</h4>
  </header>

  <div class='container list-container'>
  <ul class='list taxonomy-cloud'><li>
        <a href='/tags/.net-4.0/' style='font-size:1em'>.net 4.0</a>
      </li><li>
        <a href='/tags/addon/' style='font-size:1.0666666666666667em'>addon</a>
      </li><li>
        <a href='/tags/ado.net/' style='font-size:1em'>ado.net</a>
      </li><li>
        <a href='/tags/arvixe/' style='font-size:1.0333333333333334em'>arvixe</a>
      </li><li>
        <a href='/tags/batch/' style='font-size:1em'>batch</a>
      </li><li>
        <a href='/tags/best-practise/' style='font-size:1.3333333333333333em'>best practise</a>
      </li><li>
        <a href='/tags/blogger/' style='font-size:1em'>blogger</a>
      </li><li>
        <a href='/tags/bouncers/' style='font-size:1.0666666666666667em'>bouncers</a>
      </li><li>
        <a href='/tags/branding/' style='font-size:1em'>branding</a>
      </li><li>
        <a href='/tags/build/' style='font-size:1em'>build</a>
      </li><li>
        <a href='/tags/caching/' style='font-size:1.0333333333333334em'>caching</a>
      </li><li>
        <a href='/tags/client-relationship/' style='font-size:1em'>client relationship</a>
      </li><li>
        <a href='/tags/clientbase/' style='font-size:1em'>clientbase</a>
      </li><li>
        <a href='/tags/codeplex/' style='font-size:1em'>codeplex</a>
      </li><li>
        <a href='/tags/content/' style='font-size:1em'>content</a>
      </li><li>
        <a href='/tags/control-adapters/' style='font-size:1em'>control adapters</a>
      </li><li>
        <a href='/tags/csharp/' style='font-size:2em'>csharp</a>
      </li><li>
        <a href='/tags/css/' style='font-size:1em'>css</a>
      </li><li>
        <a href='/tags/cte/' style='font-size:1em'>cte</a>
      </li><li>
        <a href='/tags/database/' style='font-size:1.0333333333333334em'>database</a>
      </li><li>
        <a href='/tags/databound/' style='font-size:1em'>databound</a>
      </li><li>
        <a href='/tags/debugdiag/' style='font-size:1em'>debugdiag</a>
      </li><li>
        <a href='/tags/design/' style='font-size:1em'>design</a>
      </li><li>
        <a href='/tags/dont-try-this-at-home/' style='font-size:1em'>dont try this at home</a>
      </li><li>
        <a href='/tags/e053534f/' style='font-size:1em'>e053534f</a>
      </li><li>
        <a href='/tags/ektron/' style='font-size:1.6333333333333333em'>ektron</a>
      </li><li>
        <a href='/tags/ektron-wap/' style='font-size:1.0666666666666667em'>ektron wap</a>
      </li><li>
        <a href='/tags/elevatedpermissionscope/' style='font-size:1em'>elevatedpermissionscope</a>
      </li><li>
        <a href='/tags/episerver/' style='font-size:1em'>episerver</a>
      </li><li>
        <a href='/tags/esync/' style='font-size:1.0666666666666667em'>esync</a>
      </li><li>
        <a href='/tags/example/' style='font-size:1em'>example</a>
      </li><li>
        <a href='/tags/exception-handling/' style='font-size:1.1em'>exception handling</a>
      </li><li>
        <a href='/tags/extension-method/' style='font-size:1.1666666666666667em'>extension method</a>
      </li><li>
        <a href='/tags/faulted/' style='font-size:1em'>faulted</a>
      </li><li>
        <a href='/tags/fluffy-stuff/' style='font-size:1em'>fluffy stuff</a>
      </li><li>
        <a href='/tags/forum/' style='font-size:1.0333333333333334em'>forum</a>
      </li><li>
        <a href='/tags/generics/' style='font-size:1.1em'>generics</a>
      </li><li>
        <a href='/tags/globalization/' style='font-size:1.1em'>globalization</a>
      </li><li>
        <a href='/tags/hack/' style='font-size:1em'>hack</a>
      </li><li>
        <a href='/tags/iis/' style='font-size:1.1666666666666667em'>iis</a>
      </li><li>
        <a href='/tags/indexing-service/' style='font-size:1.0333333333333334em'>indexing service</a>
      </li><li>
        <a href='/tags/infrastructure/' style='font-size:1em'>infrastructure</a>
      </li><li>
        <a href='/tags/js/' style='font-size:1.0333333333333334em'>js</a>
      </li><li>
        <a href='/tags/linux/' style='font-size:1em'>linux</a>
      </li><li>
        <a href='/tags/localization/' style='font-size:1.1em'>localization</a>
      </li><li>
        <a href='/tags/masterpage/' style='font-size:1em'>masterpage</a>
      </li><li>
        <a href='/tags/mbunit/' style='font-size:1em'>mbunit</a>
      </li><li>
        <a href='/tags/msbuild/' style='font-size:1em'>msbuild</a>
      </li><li>
        <a href='/tags/mvc/' style='font-size:1em'>mvc</a>
      </li><li>
        <a href='/tags/n2cms/' style='font-size:1.2333333333333334em'>n2cms</a>
      </li><li>
        <a href='/tags/nuget/' style='font-size:1em'>nuget</a>
      </li><li>
        <a href='/tags/off-topic/' style='font-size:1em'>off topic</a>
      </li><li>
        <a href='/tags/opinion/' style='font-size:1em'>opinion</a>
      </li><li>
        <a href='/tags/performance/' style='font-size:1.1666666666666667em'>performance</a>
      </li><li>
        <a href='/tags/personal-project/' style='font-size:1.0333333333333334em'>personal project</a>
      </li><li>
        <a href='/tags/poet/' style='font-size:1em'>poet</a>
      </li><li>
        <a href='/tags/qnap/' style='font-size:1em'>qnap</a>
      </li><li>
        <a href='/tags/raid/' style='font-size:1em'>raid</a>
      </li><li>
        <a href='/tags/readability/' style='font-size:1em'>readability</a>
      </li><li>
        <a href='/tags/refactor/' style='font-size:1.0333333333333334em'>refactor</a>
      </li><li>
        <a href='/tags/regex/' style='font-size:1em'>regex</a>
      </li><li>
        <a href='/tags/security/' style='font-size:1.2em'>security</a>
      </li><li>
        <a href='/tags/seo/' style='font-size:1.0333333333333334em'>seo</a>
      </li><li>
        <a href='/tags/servicechannel/' style='font-size:1em'>servicechannel</a>
      </li><li>
        <a href='/tags/sql/' style='font-size:1.1333333333333333em'>sql</a>
      </li><li>
        <a href='/tags/stackoverflowexception/' style='font-size:1em'>stackoverflowexception</a>
      </li><li>
        <a href='/tags/static-analysis/' style='font-size:1.1333333333333333em'>static analysis</a>
      </li><li>
        <a href='/tags/statictestfactory/' style='font-size:1em'>statictestfactory</a>
      </li><li>
        <a href='/tags/svn/' style='font-size:1.0666666666666667em'>svn</a>
      </li><li>
        <a href='/tags/templated/' style='font-size:1em'>templated</a>
      </li><li>
        <a href='/tags/tidyproxy/' style='font-size:1.0333333333333334em'>tidyproxy</a>
      </li><li>
        <a href='/tags/tip/' style='font-size:1.1333333333333333em'>tip</a>
      </li><li>
        <a href='/tags/troubleshooting/' style='font-size:1.5em'>troubleshooting</a>
      </li><li>
        <a href='/tags/tuning/' style='font-size:1.0333333333333334em'>tuning</a>
      </li><li>
        <a href='/tags/unit-testing/' style='font-size:1em'>unit testing</a>
      </li><li>
        <a href='/tags/update-panel/' style='font-size:1em'>update panel</a>
      </li><li>
        <a href='/tags/usability/' style='font-size:1.1333333333333333em'>usability</a>
      </li><li>
        <a href='/tags/user-interface/' style='font-size:1.0333333333333334em'>user interface</a>
      </li><li>
        <a href='/tags/validation-groups/' style='font-size:1em'>validation groups</a>
      </li><li>
        <a href='/tags/version-control/' style='font-size:1.0666666666666667em'>version control</a>
      </li><li>
        <a href='/tags/vwt2oc/' style='font-size:1.2666666666666666em'>vwt2oc</a>
      </li><li>
        <a href='/tags/wcf/' style='font-size:1.0666666666666667em'>wcf</a>
      </li><li>
        <a href='/tags/web-application-project/' style='font-size:1.1333333333333333em'>web application project</a>
      </li><li>
        <a href='/tags/web-deployment-project/' style='font-size:1em'>web deployment project</a>
      </li><li>
        <a href='/tags/web-site-project/' style='font-size:1.1em'>web site project</a>
      </li><li>
        <a href='/tags/webhost4life/' style='font-size:1.0333333333333334em'>webhost4life</a>
      </li><li>
        <a href='/tags/white-label/' style='font-size:1em'>white label</a>
      </li><li>
        <a href='/tags/windbg/' style='font-size:1em'>windbg</a>
      </li><li>
        <a href='/tags/yaf/' style='font-size:1.0333333333333334em'>yaf</a>
      </li></ul>
</div>


</section>
</div>

  <div class='sidebar-overlay'></div>
</div><div class='main'><nav id='main-menu' class='menu main-menu' aria-label='Main Menu'>
  <div class='container'>
    <a class='screen-reader-text' href='#content'>Skip to Content</a>

<button id='sidebar-toggler' class='sidebar-toggler' aria-controls='sidebar'>
  <span class='screen-reader-text'>Toggle Sidebar</span>
  <span class='open'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="3" y1="12" x2="21" y2="12" />
  <line x1="3" y1="6" x2="21" y2="6" />
  <line x1="3" y1="18" x2="21" y2="18" />
  
</svg>
</span>
  <span class='close'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="18" y1="6" x2="6" y2="18" />
  <line x1="6" y1="6" x2="18" y2="18" />
  
</svg>
</span>
</button>
    <ul><li class='item'>
        <a href='/cv'>CV</a>
      </li><li class='item'>
        <a href='https://github.com/codifice/'>Repo</a>
      </li><li class='item'>
        <a href='/posts/'>Posts</a>
      </li></ul>
  </div>
</nav><div class='header-widgets'>
        <div class='container'>
    
    <style>.widget-breadcrumbs li:after{content:'\2f '}</style>
  <section class='widget widget-breadcrumbs sep-after'>
    <nav id='breadcrumbs'>
      <ol><li><a href='/'>Home</a></li><li><a href='/posts/'>Posts</a></li><li><span>Diagnosing an Ektron eSync Relationship</span></li></ol>
    </nav>
  </section></div>
      </div>

      <header id='header' class='header site-header'>
        <div class='container sep-after'>
          <div class='header-info'><p class='site-title title'>Codifice</p><p class='desc site-desc'>Artisan Development and Architecture</p>
          </div>
        </div>
      </header>

      <main id='content'>


<article lang='en' class='entry'>
  <header class='header entry-header'>
  <div class='container sep-after'>
    <div class='header-info'>
      <h1 class='title'>Diagnosing an Ektron eSync Relationship</h1>
      

    </div>
    <div class='entry-meta'>
  <span class='posted-on'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
  <line x1="16" y1="2" x2="16" y2="6"/>
  <line x1="8" y1="2" x2="8" y2="6"/>
  <line x1="3" y1="10" x2="21" y2="10"/>
  
</svg>
<span class='screen-reader-text'>Posted on </span>
  <time class='entry-date' datetime='2010-03-23T00:00:00Z'>2010, Mar 23</time>
</span>

  <span class='byline'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M21,21V20c0-2.76-4-5-9-5s-9,2.24-9,5v1"/>
  <path d="M16,6.37A4,4,0,1,1,12.63,3,4,4,0,0,1,16,6.37Z"/>
  
</svg>
<span class='screen-reader-text'> by </span><a href='/authors/martincjarvis'>Martin Jarvis</a></span>
  
<span class='reading-time'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <circle cx="12" cy="12" r="10"/>
  <polyline points="12 6 12 12 15 15"/>
  
</svg>
7 mins read
</span>


</div>


  </div>
</header>

  
  

  <div class='container entry-content'>
  Ektron’s eSync service is a great product when it’s working but getting the initial configuration right can be a bit fiddly.&nbsp; I’ve compiled a quick diagnostic procedure to resolve the most common issues, as well as some of the more common issues.<br>
<b>Note: </b>The Ektron Windows Service is usually in: <i>C:\Program Files\Ektron\EktronWindowsService30.</i> After any configuration change restart the Ektron Windows Service on every node in the relationship.<br>
<ol>
<li>Restart the Ektron Windows Service on every node within the relationship </li>
<li>Ensure that the Ektron license is valid for every database within the relationship </li>
<li>Ensure that you can access <b><i>http://&lt;DOMAINNAME&gt;/workarea/ServerControlWS.asmx</i></b> on each node of the relationship.&nbsp; <i>In load balanced environments ensure that you test each node explicitly</i>.       <ol>
<li>Check that this is the same as the WSPath in the AppSettings </li>
<li>Check that this is the same in the sitedb.config file in the Ektron Windows Service folder </li>
</ol>
</li>
<li>Ensure that each node is accessible on port 8732 from the next nodes in the chain      <ol>
<li>From the command line enter ‘<span style="font-family: Courier New;">telnet <i>servername</i> 8732</span>’ (in Server 2008/Windows 7 you will need to install the telnet client) </li>
<li>If a connection is successful, you fill see a blank screen press ctrl+c to exit and restart the service you just connected to </li>
</ol>
</li>
<li>Ensure that the SearchConfigUI tool can properly iterate through all of the IIS websites (it will group results by unique connectionstrings).      <ol>
<li>If the SearchConfigUI fails on an IIS 7 box ensure that IIS 6 Management Tools and Metabase compatability have been installed </li>
</ol>
</li>
<li>Ensure that all servers are using the same version of Ektron      <ol>
<li>Compare the filesize (and versions) of the following files within the Windows Service folder          <ul>
<li>Ektron.ASM.EktronServices30.exe </li>
<li>Ektron.ASM.AssetConfig.dll </li>
<li>Ektron.FileSync.Common.dll </li>
<li>Ektron.FileSync.Framework.dll </li>
<li>Ektron.Sync.Communication.dll </li>
<li>Ektron.Sync.SyncServices.dll </li>
</ul>
</li>
</ol>
</li>
<li>Ensure that the website is built against the same version of ektron as installed on each of the nodes      <ol>
<li>Check that the common libraries within the website bin folder and windows service folders match </li>
</ol>
</li>
<li>Check that the website bin directories are the same size on all nodes within the relationship </li>
<li>Check the Windows Service Error Log for indications of a Transport Layer Error (log files are within the /logs folder)      <ol>
<li>The following errors can indicate a DNS or Proxy issue:          <ul>
<li>The remote server returned an unexpected response: (407) Proxy Authentication Required. </li>
<li>The request failed with HTTP status 403: Forbidden </li>
<li>The HTTP request was forbidden with client authentication scheme 'Anonymous' </li>
</ul>
</li>
</ol>
</li>
<li>Ensure all nodes of the eSync relationship got all counterpart certificates installed (using <i>Security Configurator</i>)?       <ol>
<li>The Ektron Windows Service directory will contain all of the *_SyncClient.* files for each node and the *_SyncServer.* files for the local machine </li>
<li>The website root direction should contain the local machines *_SyncClient.* files and the timestamps should match the equivalent certificates in the Windows Service directory </li>
<li>Check that local machines certificates are referenced within the <b>ektron.serviceModel</b> section of the web.config </li>
<li>The Ektron.ASM.EktronServices30.exe.config file within the Windows Service folder should contain an element called <b>publicCertKeys </b>the has a reference to a client certificate for each server in the eSync relationship.&nbsp; These should be present on every machine in the relationship (they may be in a different order). </li>
<li>The website on each machine should have an <b>AppSetting</b> setting called <b>EncodedValue </b>this should be identical to the value stored within the Service Config file for the same machine.&nbsp; <i>If not, copy from the Windows Service config into the AppSetting not vice-versa.</i> </li>
</ol>
</li>
</ol>
<h4>
Common eSync Errors</h4>
<b></b>(as seen on Synchronisation Progress screen)<br>
<h5>
Object Reference Not Set To An Instance of An Object</h5>
<ol>
<li>Check that the client certificate is present in the root of the website </li>
<li>Check that local machines certificates are referenced within the <b>ektron.serviceModel</b> section of the web.config </li>
<li>Check the WSPath is correct and acccessble </li>
<li>Ensure the <b>AppPool </b>is runnning under the <b>Network Service</b> identity </li>
</ol>
<h5>
The communication object, System.ServiceModel.Channels.ServiceChannel, cannot be used for communication because it is in the Faulted state</h5>
<ol>
<li>Restart all services </li>
<li>Check that licenses are installed and valid </li>
<li>Check that certificates are installed </li>
<li>Check the WSPath is correct and acccessble</li>
<li>Compare the EncodedValue setting in the web.config with the value stored in the Ektron Service config</li>
</ol>
<h5>
SyncDatabaseFailed failed with message: Max index do not match. Local index:<i>X</i>, Remote index:<i>Y</i></h5>
<ol>
<li>Decide which server has the correct index (ie if one server has other eSync profiles that are working ok) </li>
<li>On the server that has the wrong index open the ServerInfo.xml (within the x:\sync folder) </li>
<li>Change all of the MaxId="X" values to the correct value </li>
<li>Open the Ektron database for the website with the incorrect index and modify the 'share_index' field of the settings table to the correct value </li>
<li>Restart all Ektron Windows Services within the relationship </li>
</ol>
<h5>
Invalid method invocation. Remote position is NOT staged.</h5>
<ol>
<li>Stop all <a href="http://bit.ly/d0YHh7" target="_blank" title="The ektron homepage">Ektron</a> Windows Services within the relationship </li>
<li>Create a copy of the<i> x</i>:\sync folder (where <i>x</i> is the drive letter for your workarea website) </li>
<li>Delete all of the contents of the <i>x</i>:\sync folder </li>
<li>Restart all of the Ektron Windows Services within the relationship </li>
<li>Rerun synchronisation to rebuild relationship </li>
</ol>
<h5>
SyncAssetLibraryFailed failed with message: Object reference not set to an instance of an object.</h5>
<ol>
<li>Ensure that the ‘StorageLocation’ attribute of ‘DocumentManagerData’ is set to a unique location for each environment (this is within the AssetManagement.config) (if hosted on the same server) </li>
</ol>
<h5>
No CMS400.NET sites were found at this location <i>(when configuring a new relationship)</i></h5>
<ol>
<li>Ensure that the certificates have been correctly installed on each node of the relationship. </li>
</ol>
<h5>
The Remote Position is NOT Staged (<i>when performaning an intitial sync</i>)</h5>
<ol>
<li>If a previous relationship existed between the two servers, ensure that the records relating to them have been removed from the [dbo].[scheduler] database table. </li>
<li>Remove all folders relating to the previous relationship from the x:\sync folder (and in all child folders)&nbsp;</li>
<li>Try running the sync from the target website </li>
<li>If problem persists, recreate the target min database – a previous initial sync attempt has semi-populated the target database beyond economical repair. </li>
</ol>
<h5>
eSync Status is ‘Running’ Even When There Is No Sync In Progress</h5>
<ol>
<li>Ensure that all Ektron services related to the website (development machines, build servers, etc, etc) have <b><i>exactly</i></b> the same version. </li>
<li>Manually set the status to ‘completed’ in the [dbo].[scheduler] table and restart the services. </li>
<li>If the problem recurs using SQL Profiler to find which server is updating the status (using the additional&nbsp; HostName column).&nbsp; The problem&nbsp; command starts with ‘<b>exec cms_updateschedulerun</b>’ </li>
</ol>
<h5>
Service Not Listening on port 8732 and EktronL2 Event Log contains ‘Service initialized successfully’ and ‘Service stopped successfully’</h5>
<ol>
<li>Ensure that the workarea can be opened without an error (cmslogin.aspx and /workarea/servercontrolws.asmx) </li>
<li>Restart service </li>
<li>Ensure ‘Service started successfully’ message is recorded </li>
</ol>
<h5>
SyncDatabaseFailed failed with message: The message with Action '<a href="http://tempuri.org/ISyncService/InitSession%27">http://tempuri.org/ISyncService/InitSession'</a> cannot be processed at the receiver, due to a ContractFilter mismatch at the EndpointDispatcher</h5>
<ol>
<li>Ensure that the same esync service version is installed on all nodes of the relationship </li>
</ol>
<h5>
Failed to execute the command 'DeleteCommand' for table 'content_folder_tbl' (or similar)</h5>
<ol>
<li>There’s been an irresolvable conflict, try reversing the conflict policy temporarily and resyncing after a successful sync, the original policy can be restored. </li>
</ol>
<h5>
Initial Sync Fails with a Database Constraint Error</h5>
The initial sync fails with a constraint error similar to:<br>
<ul>
<li>Violation of PRIMARY KEY constraint 'PK_history_meta_tbl' </li>
<li>The ALTER TABLE statement conflicted with the FOREIGN KEY constraint "folder_taxonomy_tbl_fk2" </li>
<li>Violation of PRIMARY KEY constraint 'PK_content_meta_tbl' </li>
</ul>
<ol>
<li>Remove the damaged sync profile (<a href="http://www.blogger.com/blogger.g?blogID=7125820631218721012#removesync">see below</a>) </li>
<li>Stop users from editing content whilst the <i>initial</i> sync is run </li>
</ol>
<h5>
Initial Sync Fails with:&nbsp; Could not find file ‘….\uploadedFiles\\metaconfig.doc'</h5>
<ol>
<li>Copy ‘metaconfig.doc’ from /assets into the uploadedFiles and uploadedImages </li>
<li>Run SearchConfigUI and rebuild catalogs </li>
<li>Re-run the intitial sync (it should pick up where it left off!).&nbsp; You shouldn’t need to remove the relationship and rebuild. </li>
</ol>
<h5>
Out of Memory Exceptions</h5>
<ol>
<li>Ensure that all servers have adequate memory </li>
<li>Reduce the batch size of the Ektron Windows Service by adding <i><b>batchsize=100</b> </i>to the 'DatabaseRuntime’ element within DbSync.config in the Ektron Windows Service folder. </li>
<li>Ensure that all servers in the relationship have the same batchsize configured. </li>
<li>Restart Ektron Service </li>
<li>Rerun sync </li>
</ol>
<h4>
The system can not find the file specified</h4>
<ol>
<li>Ensure that the three *_SyncClient.* files the the local machine</li>
<li>Ensure that local machines certificates are referenced within the <b>ektron.serviceModel</b> section of the web.config </li>
<li>If the certificates have been accidently deleted, you can copy them from the Ektron Windows Service folder into the root folder. </li>
</ol>
<h4>
Removing a Damaged eSync Relationship<a href="http://www.blogger.com/blogger.g?blogID=7125820631218721012" id="removesync" name="removesync"></a></h4>
If an initial sync has failed it can leave a partially populated sync relationship that will need to be removed.&nbsp; Each time this is run the Max Server index will be incremented.<br>
The procedure to do this is:<br>
<ol>
<li>Stop Ektron Service </li>
<li>Deleting the target database </li>
<li>Remove the corresponding entries from 'scheduler' table in the sending database </li>
<li>Remove entries from 'X:\sync\ServerInfo.xml' on both servers </li>
<li>Remove any folders (for the target environment) in X:\sync folder </li>
<li>Remote entries from sitedb.conf for connections on both servers </li>
<li>Remove contents of 'assets' and 'privateAssets' on target server </li>
<li>Reinstall min database (using Site Setup) </li>
<li>Recreate indexies using SearchConfigUI on target server </li>
<li>Configure and run initial sync </li>
</ol>

</div>

  
<footer class='entry-footer'>
  <div class='container sep-before'><div class='last-updated'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M20 14.66V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h5.34" />
  <polygon points="18 2 22 6 12 16 8 16 8 12 18 2" />
  
</svg>
<span class='screen-reader-text'>Last updated: </span>
      <time class='entry-date' datetime='2013-02-15T00:00:00Z'>2013, Feb 15</time>
    </div><div class='tags'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M20.59,13.41l-7.17,7.17a2,2,0,0,1-2.83,0L2,12V2H12l8.59,8.59A2,2,0,0,1,20.59,13.41Z"/>
  <line x1="7" y1="7" x2="7" y2="7"/>
  
</svg>
<span class='screen-reader-text'>Tags: </span><a class='tag' href='/tags/esync/'>esync</a>, <a class='tag' href='/tags/ektron/'>ektron</a>, <a class='tag' href='/tags/servicechannel/'>servicechannel</a>, <a class='tag' href='/tags/wcf/'>wcf</a>, <a class='tag' href='/tags/troubleshooting/'>troubleshooting</a>, <a class='tag' href='/tags/faulted/'>faulted</a></div>

  </div>
</footer>


</article>

<nav class='entry-nav'>
  <div class='container'><div class='prev-entry sep-before'>
      <a href='/posts/2010-03-22-working-with-ektron-using-web/'>
        <span aria-hidden='true'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="20" y1="12" x2="4" y2="12"/>
  <polyline points="10 18 4 12 10 6"/>
  
</svg>
 Previous</span>
        <span class='screen-reader-text'>Previous post: </span>Ektron and Web Application Projects (Part 1)</a>
    </div><div class='next-entry sep-before'>
      <a href='/posts/2010-03-24-ektron-and-web-application-projects/'>
        <span class='screen-reader-text'>Next post: </span>Ektron and Web Application Projects (Part 2)<span aria-hidden='true'>Next <svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="4" y1="12" x2="20" y2="12"/>
  <polyline points="14 6 20 12 14 18"/>
  
</svg>
</span>
      </a>
    </div></div>
</nav>




      </main>

      <footer id='footer' class='footer'>
        <div class='container sep-before'><section class='widget widget-social_menu sep-after'><nav aria-label='Social Menu'>
    <ul><li>
        <a href='https://github.com/codifice' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Github account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
  
</svg>
</a>
      </li><li>
        <a href='mailto:martin@codifice.uk' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Contact via Email</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
  <polyline points="22,6 12,13 2,6"/>
  
</svg>
</a>
      </li><li>
        <a href='https://linkedin.com/in/martincjarvis' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Linkedin account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"/>
  <rect x="2" y="9" width="4" height="12"/>
  <circle cx="4" cy="4" r="2"/>
  
</svg>
</a>
      </li></ul>
  </nav>
</section><div class='copyright'>
  <p> &copy; 2020 Codifice Ltd </p>
</div>

        </div>
      </footer>

    </div>
  </div><script>window.__assets_js_src="/assets/js/"</script>

<script src='/assets/js/main.c3bcf2df.js'></script><script src='/js/custom.js'></script>

</body>

</html>

