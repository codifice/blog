---
title: "N2CMS Forum Addon: Fixing the Theme"
date: 2010-06-09
lastmod: 2010-06-09
draft: false
tags: ["forum","addon","vwt2oc","csharp","n2cms","troubleshooting","yaf"]
authors: ["martincjarvis"]
---<i>My work on the VWT2OC site is on hiatus at the moment due to hosting issues so I thought I’d blog a useful fix that I’ve found.</i><br>
I’ve noticed a bug with the Forum Addon.&nbsp; The first page would be correctly themed but any subsequent pages were not when running against a build of the latest N2CMS.<br>
On investigation it seems that the Forum Pages CurrentItem was resolving to null which prevented the ThemeConcern for assigning the correct theme:<br>
<div id="codeSnippetWrapper" style="background-color: #f4f4f4; border: 1px solid silver; cursor: text; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 20px 0px 10px; max-height: 200px; overflow: auto; padding: 4px; text-align: left; width: 97.5%;">
<div id="codeSnippet" style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; overflow: visible; padding: 0px; text-align: left; width: 100%;">
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum1" style="color: #606060;">   1:</span> <span style="color: blue;">namespace</span> N2.Templates.Web</pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum2" style="color: #606060;">   2:</span> {</pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum3" style="color: #606060;">   3:</span>     <span style="color: green;">/// &lt;summary&gt;</span></pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum4" style="color: #606060;">   4:</span>     <span style="color: green;">/// Sets the theme of the page template.</span></pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum5" style="color: #606060;">   5:</span>     <span style="color: green;">/// &lt;/summary&gt;</span></pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum6" style="color: #606060;">   6:</span>     [Service(<span style="color: blue;">typeof</span>(TemplateConcern))]</pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum7" style="color: #606060;">   7:</span>     <span style="color: blue;">public</span> <span style="color: blue;">class</span> ThemeConcern : TemplateConcern</pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum8" style="color: #606060;">   8:</span>     {</pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum9" style="color: #606060;">   9:</span>         <span style="color: blue;">public</span> <span style="color: blue;">override</span> <span style="color: blue;">void</span> OnPreInit(ITemplatePage template)</pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum10" style="color: #606060;">  10:</span>         {</pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum11" style="color: #606060;">  11:</span>             var item = template.CurrentItem;</pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum12" style="color: #606060;">  12:</span>             <span style="color: blue;">if</span> (item == <span style="color: blue;">null</span>)</pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum13" style="color: #606060;">  13:</span>                 <span style="color: blue;">return</span>; <span style="color: green;">// &lt;=== D'oh!  This is why the forum has no theme!</span></pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum14" style="color: #606060;">  14:</span>             </pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum15" style="color: #606060;">  15:</span>             <span style="color: green;">/* Implementation doesn't matter here as it will never run! */</span></pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum16" style="color: #606060;">  16:</span>&nbsp; </pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum17" style="color: #606060;">  17:</span>         }</pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum18" style="color: #606060;">  18:</span>     }</pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum19" style="color: #606060;">  19:</span> }</pre>
</div>
</div>
Looking into the N2.Templates.dll that comes the the Forum Addon, it looks like things were handled differently back in the day, with the N2.Templates.Web.ThemeModifier just using the theme for that start page:<br>
<div id="codeSnippetWrapper" style="background-color: #f4f4f4; border: 1px solid silver; cursor: text; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 20px 0px 10px; max-height: 200px; overflow: auto; padding: 4px; text-align: left; width: 97.5%;">
<div id="codeSnippet" style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; overflow: visible; padding: 0px; text-align: left; width: 100%;">
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum1" style="color: #606060;">   1:</span> <span style="color: blue;">public</span> <span style="color: blue;">void</span> Modify&lt;T&gt;(TemplatePage&lt;T&gt; page) <span style="color: blue;">where</span> T: AbstractPage</pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum2" style="color: #606060;">   2:</span> {</pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum3" style="color: #606060;">   3:</span>     <span style="color: blue;">string</span> theme = GenericFind&lt;ContentItem, StartPage&gt;.StartPage.Theme;</pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum4" style="color: #606060;">   4:</span>     <span style="color: blue;">if</span> ((!<span style="color: blue;">this</span>.themeVerified &amp;&amp; (theme != <span style="color: blue;">null</span>)) &amp;&amp; Directory.Exists(page.Server.MapPath(<span style="color: #006080;">"~/App_Themes/"</span> + theme)))</pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum5" style="color: #606060;">   5:</span>     {</pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum6" style="color: #606060;">   6:</span>         <span style="color: blue;">this</span>.themeVerified = <span style="color: blue;">true</span>;</pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum7" style="color: #606060;">   7:</span>     }</pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum8" style="color: #606060;">   8:</span>     <span style="color: blue;">if</span> (<span style="color: blue;">this</span>.themeVerified)</pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum9" style="color: #606060;">   9:</span>     {</pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum10" style="color: #606060;">  10:</span>         page.Theme = theme;</pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum11" style="color: #606060;">  11:</span>     }</pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum12" style="color: #606060;">  12:</span> }</pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum13" style="color: #606060;">  13:</span>&nbsp; </pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum14" style="color: #606060;">  14:</span> <span style="color: green;">/* Taken from Reflector</span></pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum15" style="color: #606060;">  15:</span> <span style="color: green;">public void Modify&lt;T&gt;(TemplatePage&lt;T&gt; page) where T: AbstractPage;</span></pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum16" style="color: #606060;">  16:</span> <span style="color: green;"> </span></pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum17" style="color: #606060;">  17:</span> <span style="color: green;">Declaring Type: N2.Templates.Web.ThemeModifier </span></pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum18" style="color: #606060;">  18:</span> <span style="color: green;">Assembly: N2.Templates, Version=1.0.403.25743 </span></pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum19" style="color: #606060;">  19:</span> <span style="color: green;">*/</span></pre>
</div>
</div>
So, the fix is to make the forum page take the theme from the start page, without affecting other page types…..tricky whilst maintaining separation of concerns…hmm.<br>
<h4>
The Fix</h4>
The fix has to belong with the forum addon so that the change in behaviour doesn’t knacker the standard <a href="http://bit.ly/aco4m4" target="_blank" title="N2 CMS">n2cms</a> features.&nbsp; N2CMS populates the CurrentItem property based on the current url and as the Forum Plugin is generating links directly to it’s core template (/Forum/UI/Views/Forum.aspx) this is causing a problem.<br>
Fortunately, the YAF Framework provides an extension point we can use to fix the problem yaf.IUrlBuilder.&nbsp; This is a simple interface which takes the query string parameters and returns the appropriate link.<br>
<div id="codeSnippetWrapper" style="background-color: #f4f4f4; border: 1px solid silver; cursor: text; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 20px 0px 10px; max-height: 200px; overflow: auto; padding: 4px; text-align: left; width: 97.5%;">
<div id="codeSnippet" style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; overflow: visible; padding: 0px; text-align: left; width: 100%;">
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum1" style="color: #606060;">   1:</span> <span style="color: blue;">using</span> System.Web;</pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum2" style="color: #606060;">   2:</span>&nbsp; </pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum3" style="color: #606060;">   3:</span> <span style="color: blue;">namespace</span> N2.Templates.Forum</pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum4" style="color: #606060;">   4:</span> {</pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum5" style="color: #606060;">   5:</span>     <span style="color: green;">/// &lt;summary&gt;</span></pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum6" style="color: #606060;">   6:</span>     <span style="color: green;">/// Build links from the current page</span></pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum7" style="color: #606060;">   7:</span>     <span style="color: green;">/// &lt;/summary&gt;</span></pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum8" style="color: #606060;">   8:</span>     <span style="color: blue;">public</span> <span style="color: blue;">class</span> N2UrlLinkBuilder : yaf.IUrlBuilder</pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum9" style="color: #606060;">   9:</span>     {</pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum10" style="color: #606060;">  10:</span>         <span style="color: #cc6633;">#region</span> IUrlBuilder Members</pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum11" style="color: #606060;">  11:</span>&nbsp; </pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum12" style="color: #606060;">  12:</span>         <span style="color: green;">/// &lt;summary&gt;</span></pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum13" style="color: #606060;">  13:</span>         <span style="color: green;">/// Builds the URL.</span></pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum14" style="color: #606060;">  14:</span>         <span style="color: green;">/// &lt;/summary&gt;</span></pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum15" style="color: #606060;">  15:</span>         <span style="color: green;">/// &lt;param name="url"&gt;The URL.&lt;/param&gt;</span></pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum16" style="color: #606060;">  16:</span>         <span style="color: green;">/// &lt;returns&gt;&lt;/returns&gt;</span></pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum17" style="color: #606060;">  17:</span>         <span style="color: blue;">public</span> <span style="color: blue;">string</span> BuildUrl(<span style="color: blue;">string</span> url)</pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum18" style="color: #606060;">  18:</span>         {</pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum19" style="color: #606060;">  19:</span>             <span style="color: blue;">return</span> <span style="color: blue;">string</span>.Format(<span style="color: #006080;">"{0}?{1}"</span>, HttpContext.Current.Request.RawUrl.Split(<span style="color: #006080;">'?'</span>)[0], url);</pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum20" style="color: #606060;">  20:</span>         }</pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum21" style="color: #606060;">  21:</span>&nbsp; </pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum22" style="color: #606060;">  22:</span>         <span style="color: #cc6633;">#endregion</span></pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum23" style="color: #606060;">  23:</span>     }</pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum24" style="color: #606060;">  24:</span> }</pre>
</div>
</div>
Unfortunately, YAF doesn’t allow you to set the link builder via configuration – it has to be done programmatically.&nbsp; So you’ll need to amend ‘/Forum/UI/Views/Forum.aspx’ to ensure it’s set:<br>
<div id="codeSnippetWrapper" style="background-color: #f4f4f4; border: 1px solid silver; cursor: text; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 20px 0px 10px; max-height: 200px; overflow: auto; padding: 4px; text-align: left; width: 97.5%;">
<div id="codeSnippet" style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; overflow: visible; padding: 0px; text-align: left; width: 100%;">
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum1" style="color: #606060;">   1:</span> <span style="color: blue;">namespace</span> N2.Templates.Forum.UI.Views</pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum2" style="color: #606060;">   2:</span> {</pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum3" style="color: #606060;">   3:</span>     <span style="color: blue;">public</span> <span style="color: blue;">partial</span> <span style="color: blue;">class</span> Forum : N2.Templates.Web.UI.TemplatePage&lt;Items.Forum&gt;</pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum4" style="color: #606060;">   4:</span>     {</pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum5" style="color: #606060;">   5:</span>         <span style="color: blue;">protected</span> <span style="color: blue;">override</span> <span style="color: blue;">void</span> OnPreInit(EventArgs e)</pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum6" style="color: #606060;">   6:</span>         {</pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum7" style="color: #606060;">   7:</span>             <span style="color: blue;">if</span> (!(yaf.Config.IsRainbow || yaf.Config.IsDotNetNuke || yaf.Config.IsPortal || yaf.Config.EnableURLRewriting == <span style="color: #006080;">"true"</span>)) <span style="color: green;">// based on logic found in yaf.Config</span></pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum8" style="color: #606060;">   8:</span>                 HttpContext.Current.Application[<span style="color: #006080;">"yaf_UrlBuilder"</span>] = <span style="color: blue;">new</span> N2UrlLinkBuilder();</pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum9" style="color: #606060;">   9:</span>             <span style="color: blue;">base</span>.OnPreInit(e);</pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum10" style="color: #606060;">  10:</span>         }</pre>
<pre style="background-color: white; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum11" style="color: #606060;">  11:</span>     }</pre>
<pre style="background-color: #f4f4f4; border-style: none; color: black; direction: ltr; font-family: 'Courier New',courier,monospace; font-size: 8pt; line-height: 12pt; margin: 0em; overflow: visible; padding: 0px; text-align: left; width: 100%;"><span id="lnum12" style="color: #606060;">  12:</span> }</pre>
</div>
</div>
Another possible workaround is to investigate the UrlRewriting….but this look too involved for the time available.